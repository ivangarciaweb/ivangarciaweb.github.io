function clearInput(t){t.value=""}function searchBarCode(t){document.getElementById("buttonSearch").addEventListener("click",function(){let n=document.getElementById("inputText"),a=n.value;clearInput(n),bringProductInfo(t,a)})}function clearList(t){t.innerHTML=""}function writeProductInfo(t,n){if("product found"==n.status_verbose&&null!=n.code){const a={};a.value=n.product.nutrition_grades,"a"!=a.value&&"A"!=a.value||(a.src="img/nutriscore-a.svg"),"b"!=a.value&&"B"!=a.value||(a.src="img/nutriscore-b.svg"),"c"!=a.value&&"C"!=a.value||(a.src="img/nutriscore-c.svg"),"d"!=a.value&&"D"!=a.value||(a.src="img/nutriscore-d.svg"),"e"!=a.value&&"E"!=a.value||(a.src="img/nutriscore-e.svg");let e=n.product.nutriments.sodium_100g;void 0!==e&&(e=e.toFixed(3));document.getElementById("modalEnterBarcode");t.innerHTML=`\n\t\t<h2>${n.product.product_name}</h2>\n\t\t<ul class="gallery">\n\t\t\t<li><img src="${n.product.image_url}"></p></li>\n\t\t</ul>\t\n\t\t<ul class="productProperties">\n\t\t\t<li><p><span class="title">Marca:</span><span class="description">${n.product.brands}</span></p></li>\n\t\t\t<li><p><span class="title">Nombre del producto:</span><span class="description">${n.product.product_name}</span></p></li>\n\t\t\t<li><p><span class="title">Código de barras:</span><span class="description">${n.product.code}</span></p></li>\n\t\t\t<li><p><span class="title">Categoria:</span><span class="description">${n.product.categories}</span></p></li>\n\t\t\t<li><p><span class="title">País de procedencia:</span><span class="description">${n.product.countries}</span></p></li>\n\t\t\t<li><p><span class="title">Ingredientes:</span><span class="description">${n.product.ingredients_text}</span></p></li>\n\t\t\t<li><p><span class="title">Alérgenos:</span><span class="description">${n.product.allergens}</span></p></li>\n\t\t\t<li><p><span class="title">Nivel de grasa:</span><span class="description">${n.product.nutrient_levels.fat}</span></p></li>\n\t\t\t<li><p><span class="title">Nivel de sal:</span><span class="description">${n.product.nutrient_levels.salt}</span></p></li>\n\t\t\t<li><p><span class="title">Nivel de azúcares:</span><span class="description">${n.product.nutrient_levels.sugars}</span></p></li>\n\t\t\t<li><p><span class="title">Posibles trazas de:</span><span class="description">${n.product.traces}</span></p></li>\n\t\t\t<li><p><span class="title">Última actualización:</span><span class="description">${n.product.last_edit_dates_tags[2]}</span></p></li>\n\t\t\t<li><p><span class="title">Envase:</span><span class="description">${n.product.packaging}</span></p></li>\n\t\t\t<li><p><span class="title">Peso:</span><span class="description">${n.product.quantity}</span></p></li>\n\t\t\t<li><p><span class="title">Lugar de fabricación:</span><span class="description">${n.product.manufacturing_places}</span></p></li>\n\t\t\t<li><p><span class="title">Nutriscore:</span><span class="description"><img src="${a.src}" alt="${n.product.brands}"></span></p></li>\n\t\t</ul>\t\t\n\t\t<table class="table table-bordered">\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>Valor Nutricional</th>\n\t\t\t\t\t<th>100g</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Valor Energético</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.energy_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Carbohidratos</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.carbohydrates_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Grasas</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.fat_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Fibra</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.fiber_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Proteinas</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.proteins_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Sal</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.salt_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Grasas Saturadas</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.fat_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Sodio</td>\n\t\t\t\t\t\t<td>${e}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Azucares</td>\n\t\t\t\t\t\t<td>${n.product.nutriments.sugars_100g}</td>\n\t\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t\t`}else t.innerHTML='\n\t\t\t<h4 class="error"><span class="title">!</span><br/><br/>¡Ups! No se ha encontrado el producto relacionado con este código de barras en nuestra base de datos. Prueba a reescribirlo o introducir otro.</h4>\n\t\t'}async function bringProductInfo(t,n){let a=t+n+".json",e=await fetch(a),s=await e.json();console.log(s),clearList(productsList),writeProductInfo(productsList,s)}let productsList=document.getElementById("productInfo");const url="https://world.openfoodfacts.org/api/v0/product/";searchBarCode(url),$(function(){var t={inputStream:{type:"LiveStream",constraints:{aspectRatio:{min:1,max:100},facingMode:"environment"}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency?navigator.hardwareConcurrency:4,decoder:{readers:[{format:"ean_reader",config:{}}]},locate:!0},n=$.extend({},t,{inputStream:{size:800}});$("#livestream_scanner").on("shown.bs.modal",function(n){Quagga.init(t,function(t){if(t)return $("#livestream_scanner .modal-body .error").html('<div class="alert alert-danger"><span class="title"><i class="fa fa-exclamation-triangle"></i> '+t.name+"</span>: "+t.message+"</div>"),void Quagga.stop();Quagga.start()})}),Quagga.onProcessed(function(t){var n=Quagga.canvas.ctx.overlay,a=Quagga.canvas.dom.overlay;t&&(t.boxes&&(n.clearRect(0,0,parseInt(a.getAttribute("width")),parseInt(a.getAttribute("height"))),t.boxes.filter(function(n){return n!==t.box}).forEach(function(t){Quagga.ImageDebug.drawPath(t,{x:0,y:1},n,{color:"green",lineWidth:2})})),t.box&&Quagga.ImageDebug.drawPath(t.box,{x:0,y:1},n,{color:"#00F",lineWidth:2}),t.codeResult&&t.codeResult.code&&Quagga.ImageDebug.drawPath(t.line,{x:"x",y:"y"},n,{color:"red",lineWidth:3}))}),Quagga.onDetected(function(t){t.codeResult.code&&($("#inputText").val(t.codeResult.code),Quagga.stop(),setTimeout(function(){$("#livestream_scanner").modal("hide")},1e3),document.getElementById("buttonSearch").click())}),$("#livestream_scanner").on("hide.bs.modal",function(){Quagga&&Quagga.stop()}),$("#livestream_scanner input:file").on("change",function(t){t.target.files&&t.target.files.length&&Quagga.decodeSingle($.extend({},n,{src:URL.createObjectURL(t.target.files[0])}),function(t){alert(t.codeResult.code)})})});